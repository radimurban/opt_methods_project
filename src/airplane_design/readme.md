# 2. Optimizing the design of an aircraft (ODA)
Optimizing the design of an aircraft to maximize lift. We model this problem as having a few components for which we want to maximize the lift force. To limit the ranges of the components, we assume we are modeling this problem on an airliner (e.g. Boeing 777 and similar).

## Population
Let's assume that each candidate solution (i.e., chromosome) in the population is represented by a vector $p = (V, S, \alpha , e, AR) \in \mathbb{R}^5$ of design variables that define a part of an aircraft. The dimensions correspond to:

- $V$ is the speed of the aircraft ($m/s$)  $\in \[50; 350\]$
- $S$ is the wing area ($m^2$)  $\in \[60; 200\]$
- $\alpha$ is the angle of attack (rad)  $\in \[0; 0.43\]$
- $e$ is the Oswald efficiency factor  $\in \[0; 1\]$
- $AR$ is the wing aspect ratio  $\in \[5; 15\]$

## Fitness function
Each chromosome is evaluated by a fitness function that computes its performanceand assigns a fitness score. In this case we want to compute the maximum lift.

**Lift ($L$):** The lift generated by the plane depends on the air density, the speed of the aircraft, and the geometry of the wing. The lift can be computed using the following formula:

$$
L = \frac{1}{2} * \rho * V^2 * S * \frac{(2 * \pi * \alpha)}{ (1 + (\pi * e * AR))}
$$

where:
- $\rho$ is the air density (kg/m^3) -> Assume constant at $1.293 kg/m^3$

## Parent Selection
We will choose two parents. Both as chromosome maximizing the fitness function among 10 randomly selected chromosomes (*Tournament Selection*)
Some randomness might make sense because for example of different conditions for the plane (meaning, the chromosome maximizing the fitness function might not maximize it in all conditions). 

Selecting one parent will look like this:

```java
Chromosome best = null;
    for (int i = 0; i < 10; i++) {
        Chromosome individual = individuals[random.nextInt(individuals.length)];
        if (best == null || individual.getFitness() > best.getFitness()) {
            best = individual;
        }
    }
return best;
```

## Generating Children
We generate children as follows. To optimize but also to keep randomness in the process we _randomly_ mix the genes of the two parents. (Unifrom Crossover with randomly generated mask)

```java
public Chromosome[] crossover(Chromosome other) {
    double[] childGenes = new double[genes.length];
    double[] otherChildGenes = new double[genes.length];

    for (int i = 0; i < childGenes.length; i++) {
        boolean mask = random.nextBoolean();

        // Mask bit stays unchanged for both assignments => children inherit from different parents
        childGenes[i] = mask ? this.getGenes()[i] : other.getGenes()[i];
        otherChildGenes[i] = mask ? other.getGenes()[i] : this.getGenes()[i];
        
    }

    Chromosome first_child = new Chromosome(childGenes);
    Chromosome second_child = new Chromosome(otherChildGenes);
    Chromosome[] children = {first_child, second_child};

    return children;
}
```
We then replace the worst individuals (lowest fitness score) with just generated children.
```java
// Crossover
Chromosome[] children = parent1.crossover(parent2);

// Replace x worst individuals with x children
for (Chromosome child : children){
    population.replaceWorst(child);
}
```
## Stopping Criteria
We will pre-define the number of generations we want to optimize over and abort after achieving this number.

## Sample Results
Following result was obtained by having `POPULATION_SIZE = 150` and stopping criteria constant `MAX_GENERATIONS = 100`.
```
Generation: 1
Best fitness: 8121325.844336658
Generation: 2
Best fitness: 8121325.844336658
Generation: 3
Best fitness: 8121325.844336658
...
...
...
Generation: 73
Best fitness: 9273070.677375384
Generation: 74
Best fitness: 9273070.677375384
Generation: 75
Best fitness: 9273070.677375384
Generation: 76
Best fitness: 1.2647211860884406E7

...
...

Generation: 96
Best fitness: 1.2647211860884406E7
Generation: 97
Best fitness: 1.2647211860884406E7
Generation: 98
Best fitness: 1.2647211860884406E7
Generation: 99
Best fitness: 1.2647211860884406E7
Generation: 100
Best fitness: 1.2647211860884406E7

------Component--------|----Value----

Speed of the aircraift:   345.61
Wing area:                189.95
Angle of attack:          0.41
Oswald eff. factor:       0.12
Wing aspect ratio:        5.29

```
Result is returning the maximized Lift $L$. At this point it would obviously easy to extract the genes which have maximized this property.\
We can reason that the delievered result is somewhat reasonable by realizing that a loaded airplane can weigh _up to_ $600.000 kg$ corresponding rouhgly to needed lift of at least $6MN$. At generation 100, the best configuration has a lift force of roughly $9.5 MN$ (computed average of 10 simulations). Hence in the range of reasonable results. In real life achieving this lift by an airplane might be impossible - it's more about a half of our computed maximum. Result is coming from simplifying and theoretizing about the components and their ranges.
